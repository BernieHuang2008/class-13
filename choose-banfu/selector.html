<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>班服选择器</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .selector-container {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }

        .selector-group {
            flex: 1;
        }

        .selector-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        select,
        input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        .preview-container {
            text-align: center;
            position: relative;
            display: inline-block;
        }

        .clothes-image {
            max-width: 300px;
            max-height: 400px;
            transition: filter 0.3s ease;
        }

        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
        }

        .zipper {
            width: 4px;
            height: 80%;
            background-color: #666;
            position: absolute;
            left: 50%;
            top: 10%;
            transform: translateX(-50%);
        }

        .logo {
            width: 30%;
            height: 100%;
            position: absolute;
            left: 50%;
            top: 38%;
            transform: translateX(-50%);
            background-image: url("9bc6c230aae52903eb94d8ed4c078957.jpg");
            background-size: contain;
            background-repeat: no-repeat;
        }

        .buttons {
            position: absolute;
            left: 50%;
            top: 20%;
            transform: translateX(-50%);
        }

        .button {
            width: 12px;
            height: 12px;
            background-color: #333;
            border-radius: 50%;
            margin: 15px 0;
        }

        .footer {
            color: red;
        }
    </style>
</head>

<body>
    <div id="main-content">
        <h1>班服选择器</h1>

        <div class="selector-container">
            <div class="selector-group">
                <label for="clothing-type">服装类型：</label>
                <select id="clothing-type">
                    <option value="外套">外套</option>
                    <option value="卫衣">卫衣</option>
                    <option value="棒球服">棒球服</option>
                </select>
            </div>

            <div class="selector-group">
                <label for="closure-type">开合方式：</label>
                <select id="closure-type">
                    <option value="拉链">拉链</option>
                    <option value="纽扣">纽扣</option>
                    <option value="无">无</option>
                </select>
            </div>

            <div class="selector-group">
                <label for="color-type">颜色：</label>
                <select id="color-type">
                    <option value="黑白" data-filter="grayscale(1)">黑白</option>
                    <option value="蓝白" data-hue="0">蓝白</option>
                    <option value="绿白" data-hue="268">绿白</option>
                    <option value="红白" data-hue="125">红白</option>
                </select>
            </div>
        </div>

        <div class="footer">注意：程序仅供炫技，图片仅供参考，请以选项描述为准!</div>

        <div class="preview-container">
            <img id="clothes-image" class="clothes-image" src="https://pic.mksucai.com/00/37/69/72aaf554e8edf758.webp"
                alt="服装预览">
            <div id="overlay" class="overlay"></div>
        </div>

        <div style="text-align: center; margin-top: 20px;">
            <button id="submit-btn" onclick="submitData()"
                style="padding: 10px 20px; background-color: #007cba; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px;">
                提交选择
            </button>
        </div>

        <script>
            function submitData() {
                var choice_1 = document.getElementById('clothing-type').value;
                var choice_2 = document.getElementById('closure-type').value;
                var choice_3 = document.getElementById('color-type').value;

                var choice = `${choice_1}-${choice_2}-${choice_3}`;
                window.location.href = `?${choice}`;
            }
        </script>
    </div>
    </div>

    <script>
        const clothingType = document.getElementById('clothing-type');
        const closureType = document.getElementById('closure-type');
        const colorType = document.getElementById('color-type');
        const customColorGroup = document.getElementById('custom-color-group');
        const clothesImage = document.getElementById('clothes-image');
        const overlay = document.getElementById('overlay');

        const clothingUrls = {
            外套: 'https://pic.pngsucai.com/00/27/73/dca0bc29182c0f9a.webp',
            卫衣: 'https://img.alicdn.com/bao/uploaded/i4/377819308/O1CN01iUhl1g2Id7EqoXoOU_!!377819308.jpg',
            棒球服: 'https://ts1.tc.mm.bing.net/th/id/OIP-C.blUCY1HunVK_iZydA_iwpAAAAA'
        };

        var render_selector = true;
        if (document.location.href.split('?').length > 1) {
            var page_id = document.location.href.split('?')[1];
            var choices = page_id.indexOf('-') != -1 ? page_id.split('-') : [];
            document.innerHTML = '';
            var iframe_html = "";
            choices.forEach(c => {
                iframe_html += `<iframe src="?${c}" style="display: none"></iframe>`;
            })
            document.write('<script defer src=\"tonji.js\"><\/script>' + `<h2>选项：${decodeURI(page_id)}</h2><h2>已选人数：<span id="page_uv"><span style="color: red">正在提交，别关窗口</span></span></h2><br><br><hr><h1>提交成功</h1>` + iframe_html);
            document.querySelector("#main-content").style.display = "none";
        }

        function updatePreview() {
            // 更新服装图片
            clothesImage.src = clothingUrls[clothingType.value];

            // 更新颜色滤镜
            let hueValue = 0;
            if (colorType.value === 'custom') {

            } else {
                filterValue = colorType.options[colorType.selectedIndex].dataset.filter;
                hueValue = colorType.options[colorType.selectedIndex].dataset.hue;
            }
            if (filterValue)
                clothesImage.style.filter = `${filterValue}`;
            if (hueValue)
                clothesImage.style.filter = `hue-rotate(${hueValue}deg)`;
            // 更新开合方式叠加层
            overlay.innerHTML = '';
            if (closureType.value === '拉链') {
                overlay.innerHTML = '<div class="zipper"></div>';
            } else if (closureType.value === '纽扣') {
                overlay.innerHTML = `
                    <div class="buttons">
                        <div class="button"></div>
                        <div class="button"></div>
                        <div class="button"></div>
                        <div class="button"></div>
                    </div>
                `;
            }
            overlay.innerHTML += '<div class="logo"></div>';
        }

        if (render_selector) {
            // 事件监听器
            clothingType.addEventListener('change', updatePreview);
            closureType.addEventListener('change', updatePreview);
            colorType.addEventListener('change', () => {
                updatePreview();
            });
            // setInterval(() => {
            //     updatePreview();
            // }, 500);

            // 初始化
            updatePreview();
        }
    </script>
</body>

</html>